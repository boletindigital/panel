angular.module("RDash",["ui.bootstrap","ui.router","ngCookies","angularUtils.directives.dirPagination","ui.select","ngSanitize","ui.mask","angular-jwt","toastr"]);
angular.module("RDash").config(["$httpProvider","jwtInterceptorProvider",function(e,t){t.tokenGetter=["jwtHelper","$http",function(e,t){var r=localStorage.getItem("DAF_access_jwt"),n=localStorage.getItem("DAF_refresh_jwt");return null===r?void console.debug("daf::missing dafAccessJWT"):e.isTokenExpired(r)?t({url:"https://api.boletin.damianfernandez.mx/oauth/access_token/?grant_type=refresh_token&refresh_token="+n,skipAuthorization:!0,method:"POST",data:{grant_type:"refresh_token",refresh_token:n}}).then(function(e){var t=e.data.access_token;return localStorage.setItem("ARIA_access_jwt",t),t}):r}],e.interceptors.push("jwtInterceptor")}]);
"use strict";angular.module("RDash").config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/entrar"),t.state("index",{url:"/",templateUrl:"templates/dashboard.html"}).state("busqueda",{url:"/busqueda",templateUrl:"templates/busqueda.html"}).state("tables",{url:"/tables",templateUrl:"templates/tables.html"}).state("entrar",{url:"/entrar",templateUrl:"templates/login.html"})}]);
function AlertsCtrl(e){e.alerts=[{type:"success",msg:"Thanks for visiting! Feel free to create pull requests to improve the dashboard!"},{type:"danger",msg:"Found a bug? Create an issue with as many details as you can."}],e.addAlert=function(){e.alerts.push({msg:"Another alert!"})},e.closeAlert=function(t){e.alerts.splice(t,1)}}angular.module("RDash").controller("AlertsCtrl",["$scope",AlertsCtrl]);
angular.module("RDash").controller("BusquedaCtrl",["$scope","Acuerdos","Instancias","$stateParams",function(e,a,n,t){e.id=t.fold,e.api={},e.acuerdos=[],e.instancia={selected:{clave:"JF01",organo:"J",materia:"F",numero:1,nombre:"Juzgado Familiar 1"}},e.expediente={input:20142349},e.instancias=[{clave:"JF01",organo:"J",materia:"F",numero:1,nombre:"Juzgado Familiar 1"},{clave:"JC01",organo:"J",materia:"C",numero:1,nombre:"Juzgado Civil 1"},{clave:"JO01",organo:"J",materia:"O",numero:1,nombre:"Juzgado Oral 1"}],n.all().then(function(a){e.instancias=a}),e.pagination={current:1,totalObjects:0,objectsPerPage:100},e.filter={},e.pageChanged=function(){e.api.weAreWaiting=!0;var n={};angular.copy(e.filter,n),n.page=e.pagination.current,n.organo=e.instancia.selected.organo,n.materia=e.instancia.selected.materia,n.numero=e.instancia.selected.numero,n["año"]=(""+e.expediente.input).substring(0,4),n.consecutivo=(""+e.expediente.input).substring(4,20),console.log("boletin::expediente::",e.expediente),a.getByFilter(n).then(function(a){e.acuerdos=a.data,e.pagination.totalObjects=a.total,e.filter=n,e.filter.page=void 0,e.api.weAreWaiting=!1})},e.pageChanged()}]);
angular.module("RDash").controller("DashboardCtrl",["$scope","ApiStats","$stateParams",function(t,a,e){t.api={simpleStats:{instancias:0,expedientes:0,acuerdos:0}},a.getSimpleStats().then(function(a){t.api.simpleStats=a}),t.number=function(t){return t>1e6?Math.round(t/1e6*100)/100+"M":t+""}}]);
angular.module("RDash").controller("LastDaysStatsCtrl",["$scope","ApiStats","$stateParams",function(a,t,s){a.wantedDays=[],a.api={lastDaysSimpleStats:[]};for(var e=0;e<365;e++)a.wantedDays.push(moment().startOf("day").subtract(e,"days"));a.howManyAcuerdos=function(t){var s=t.format("YYYY-MM-DD");return a.api.lastDaysSimpleStats[s]?a.api.lastDaysSimpleStats[s].acuerdos:0},a.howManyExpedientes=function(t){var s=t.format("YYYY-MM-DD");return a.api.lastDaysSimpleStats[s]?a.api.lastDaysSimpleStats[s].expedientes:0},t.lastDaysSimpleStats().then(function(t){a.api.lastDaysSimpleStats=t})}]);
angular.module("RDash").controller("LoginCtrl",["$scope","LoginProvider","$state","toastr",function(r,o,e,n){r.user={username:"",password:""},r.loginForm={message:"Continuar"},r.loginFormSubmit=function(){console.log("submit..."),a(r.user)};var s={working:!1},a=function(a){if(!s.working){if(!a.username||!a.password)return void n.warning("Por favor, ingresa tu usuario y contraseña.");s.working=!0,r.loginForm.isLoading=!0,r.loginForm.message="Conectando",o.login(a).then(function(o){if(s.working=!1,!o.data.username||!o.data.access_token)return r.loginError="Usuario o contraseña incorrectos",void n.error(r.loginError,"Error");r.loginForm.isOk=!0,r.loginForm.message="¡Adelante!",n.success("Adelante, "+o.data.username,r.loginForm.message);var a=o.data.access_token;localStorage.setItem("DAF_access_jwt",a);var t=o.data.refresh_token;localStorage.setItem("DAF_refresh_jwt",t),e.go("busqueda")},function(o){r.loginForm.message="Reintentar",r.loginForm.isLoading=!1,r.loginForm.isOk=!1,s.working=!1,401==o.status||"Unauthorized"==o.statusText?(r.loginError="Usuario o contraseña incorrectos",n.error(r.loginError,"Error")):(r.loginError="Error del servidor. ",o.statusText&&(r.loginError+=o.statusText),n.error(r.loginError,"Error"))})}}}]);
function MasterCtrl(t,e){var g=992;t.getWidth=function(){return window.innerWidth},t.$watch(t.getWidth,function(o,n){o>=g?angular.isDefined(e.get("toggle"))?t.toggle=!!e.get("toggle"):t.toggle=!0:t.toggle=!1}),t.toggleSidebar=function(){t.toggle=!t.toggle,e.put("toggle",t.toggle)},window.onresize=function(){t.$apply()}}angular.module("RDash").controller("MasterCtrl",["$scope","$cookieStore",MasterCtrl]);
function dafWidgetTitle(){var e={requires:"^rdWidget",scope:{title:"@",icon:"@",wclass:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="{{wclass}}" ng-transclude></div></div></div>',restrict:"E"};return e}angular.module("RDash").directive("dafWidgetHeader",dafWidgetTitle);
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("RDash").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"@?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("RDash").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("RDash").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("RDash").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("RDash").directive("rdWidget",rdWidget);
angular.module("RDash").factory("Acuerdos",["$http",function(t){var n="https://api.boletin.damianfernandez.mx/acuerdo",e={};return e.getByFilter=function(e){return t.post(n+"/filter",e,{headers:{"Content-Type":"application/json"}}).then(function(t){return t.data})},e}]);
angular.module("RDash").factory("ApiStats",["$http",function(t){var a="https://api.boletin.damianfernandez.mx",n={};return n.getSimpleStats=function(){return t.get(a+"/simpleStats").then(function(t){return t.data})},n.lastDaysSimpleStats=function(){return t.get(a+"/lastDaysSimpleStats?_days=365").then(function(t){return t.data})},n}]);
angular.module("RDash").factory("Instancias",["$http",function(n){var t="https://api.boletin.damianfernandez.mx/instancia",a=n.get(t).then(function(n){return n.data}),r={};return r.all=function(){return a},r}]);
angular.module("RDash").factory("LoginProvider",["$http",function(n){var t="https://api.boletin.damianfernandez.mx",a={};return a.login=function(a){return n.post(t+"/api/login",a)},a}]);